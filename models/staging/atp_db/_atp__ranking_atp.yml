sources:
  - name: extra_ranking
    database: ALUMNO26_DEV_BRONZE_DB_ATP
    schema: ATP_DB
    tables:
      - name: ranking_atp
        description: "Ranking ATP histórico desde el 2000 por jugador y fecha."
        columns:
          - name: ranking_date
            description: "Fecha del ranking en formato string (YYYYMMDD)."
            tests:
              - not_null

          - name: rank
            description: "Posición del jugador en el ranking."
            tests:
              - not_null
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 1
                  max_value: 3000
                  severity: warn

          - name: player_id
            description: "Identificador único del jugador."
            tests:
              - not_null

          - name: points
            description: "Puntos del jugador en el ranking en esa fecha."
            tests:
              - not_null
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0
                  max_value: 20000
                  severity: warn

          - name: ingesta_tmz
            description: "Timestamp de la carga del fichero en Snowflake."
            tests:
              - not_null

        tests:
          - unique:
              combination_of_columns:
                - ranking_date
                - player_id
