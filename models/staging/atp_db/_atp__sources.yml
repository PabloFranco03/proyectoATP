sources:
  - name: atp
    database: ALUMNO26_DEV_BRONZE_DB_ATP
    schema: ATP_DB
    description: "Datos brutos de partidos del circuito ATP."

    quoting:
      database: false
      schema: false
      identifier: false

    #freshness:
      #warn_after: {count: 24, period: hour}
      #error_after: {count: 48, period: hour}

    tables:
      - name: matches
        description: "Partidos oficiales ATP. Una fila por partido."
        loaded_at_field: tourney_date
        columns:
          - name: tourney_id
            description: "Identificador único del torneo."
            tests:
              - not_null

          - name: tourney_name
            description: "Nombre del torneo."
            tests:
              - not_null

          - name: surface
            description: "Tipo de superficie: Clay, Hard, Grass..."
            tests:
              #- not_null
              - accepted_values:
                  values: ['Hard', 'Clay', 'Grass']

          - name: draw_size
            description: "Número de jugadores en el cuadro principal."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 8
                  max_value: 256
                  severity: warn

          - name: tourney_level
            description: "Nivel del torneo (G: Grand Slam, M: Masters 1000, A: ATP 500, D: Davis Cup, F: Finals, O: Olympics)."
            tests:
              - not_null
              - accepted_values:
                  values: ['G', 'M', 'A', 'D', 'F', 'O']

          - name: tourney_date
            description: "Fecha de inicio del torneo (YYYYMMDD)."
            tests:
              - not_null

          - name: match_num
            description: "Número del partido dentro del torneo."

          - name: winner_id
            description: "ID del jugador que ganó el partido."
            tests:
              - not_null

          - name: winner_seed
            description: "Cabeza de serie del ganador."

          - name: winner_entry
            description: "Tipo de entrada del ganador (WC, Q, etc.)."

          - name: winner_name
            description: "Nombre completo del ganador."
            tests:
              - not_null

          - name: winner_hand
            description: "Mano dominante del ganador (L, R)."
            tests:
              - accepted_values:
                  values: ['L', 'R', 'U']

          - name: winner_ht
            description: "Altura del ganador en cm."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 140
                  max_value: 220
                  severity: warn

          - name: winner_ioc
            description: "Código IOC del país del ganador."

          - name: winner_age
            description: "Edad del ganador en el momento del partido."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 15
                  max_value: 45
                  severity: warn

          - name: loser_id
            description: "ID del jugador que perdió el partido."
            tests:
              - not_null

          - name: loser_seed
            description: "Cabeza de serie del perdedor."

          - name: loser_entry
            description: "Tipo de entrada del perdedor."

          - name: loser_name
            description: "Nombre completo del perdedor."
            tests:
              - not_null

          - name: loser_hand
            description: "Mano dominante del perdedor."
            tests:
              - accepted_values:
                  values: ['L', 'R', 'U']

          - name: loser_ht
            description: "Altura del perdedor en cm."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 140
                  max_value: 220
                  severity: warn

          - name: loser_ioc
            description: "Código IOC del país del perdedor."

          - name: loser_age
            description: "Edad del perdedor en el momento del partido."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 15
                  max_value: 45
                  severity: warn

          - name: score
            description: "Resultado del partido (ej: 6-3 4-6 7-6)."

          - name: best_of
            description: "Número máximo de sets (3 o 5)."
            tests:
              - accepted_values:
                  values: [3, 5]

          - name: round
            description: "Ronda del torneo (ej: F, SF, QF, R16, etc)."
            tests:
              - not_null
              - accepted_values:
                  values: ['F', 'SF', 'QF', 'R16', 'R32', 'RR', 'R128', 'R64', 'BR']

          - name: minutes
            description: "Duración del partido en minutos."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 10
                  severity: warn

          # Estadísticas del ganador
          - name: w_ace
            description: "Aces del ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_df
            description: "Dobles faltas del ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_svpt
            description: "Puntos al saque del ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_1stIn
            description: "Primeros servicios dentro del ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_1stWon
            description: "Puntos ganados con el primer saque."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_2ndWon
            description: "Puntos ganados con el segundo saque."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_SvGms
            description: "Juegos al saque del ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_bpSaved
            description: "Break points salvados por el ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: w_bpFaced
            description: "Break points enfrentados por el ganador."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          # Estadísticas del perdedor
          - name: l_ace
            description: "Aces del perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_df
            description: "Dobles faltas del perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_svpt
            description: "Puntos al saque del perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_1stIn
            description: "Primeros servicios dentro del perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_1stWon
            description: "Puntos ganados con el primer saque."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_2ndWon
            description: "Puntos ganados con el segundo saque."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_SvGms
            description: "Juegos al saque del perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_bpSaved
            description: "Break points salvados por el perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          - name: l_bpFaced
            description: "Break points enfrentados por el perdedor."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 0

          # Rankings
          - name: winner_rank
            description: "Ranking del ganador al momento del partido."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 1

          - name: winner_rank_points
            description: "Puntos ATP del ganador en ese momento."

          - name: loser_rank
            description: "Ranking del perdedor al momento del partido."
            tests:
              - dbt_expectations.expect_column_values_to_be_between:
                  min_value: 1

          - name: loser_rank_points
            description: "Puntos ATP del perdedor en ese momento."
